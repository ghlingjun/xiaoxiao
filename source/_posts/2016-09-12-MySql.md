---
layout: default
title: MySql 常用操作命令
date: 2016-09-12 23:09:09
tags: MySql
---
# 概述
总结的一些 MySql 操作命令

### MySql 服务启动
sudo /etc/init.d/mysqld start

## 创建用户
```
CREATE USER 'octopus'@'%' IDENTIFIED BY 'octopus';
```
## 删除用户
```
drop user 'octopus'@'%';
```
## 创建数据库
```
drop database testdb;

CREATE DATABASE testdb DEFAULT CHARACTER SET utf8;
GRANT ALL PRIVILEGES ON testdb.* TO octopus@'%' WITH GRANT OPTION;
# 查询权限用户
GRANT SELECT ON testdb.* TO octopus@'%' WITH GRANT OPTION;

FLUSH PRIVILEGES;
```

## 导入导出
### 导出表结构
```
mysqldump -h192.168.1.160 --opt --set-gtid-purged=OFF -d testdb -uoctopus -p > ddl-testdb-20160912.sql
```
### 导出数据
```
mysqldump -t -h192.168.1.160 --set-gtid-purged=OFF testdb -uoctopus -p > data-testdb-20160912.sql
```
### 导出表结构与数据
```
mysqldump -uoctopus -p --default-character-set=utf8 testdb > testdb-20160912.sql
mysqldump -uoctopus -p --default-character-set=utf8 --set-gtid-purged=OFF testdb > testdb-20160912.sql
mysqldump -uoctopus -p --default-character-set=utf8 -ntd -R testdb > testdb-20160912.sql
mysqldump -uoctopus -p --default-character-set=utf8 -h192.168.1.160 -P10002 testdb > testdb-20160912.sql
```
其中，-ntd 是表示导出存储过程；-R 是表示导出函数；-P 指定端口号；

### 导入sql脚本
- 方式一：
```
mysql -h192.168.1.160 -uoctopus -p testdb < testdb-20160912.sql
```
- 方式二：先登录数据库，然后执行命令(这种方式将顺序执行脚本，如果数据量大，不建议使用此种方式)：
```
mysql > source testdb-20160912.sql
```

## /etc/init.d/mysql: ERROR: The partition with /var/lib/mysql is too full!
磁盘空间被占满导致无法启动服务，可使用 du -sh ./* 来查看 /var 下的文件大小详情，释放一些空间，再使用启动命令 /etc/init.d/mysql start 启动。

## MySQL 启动慢查询日志
查看慢查询相关参数：
```
show variables like 'slow_query%';
```
方式一：命令设置：
```
set global slow_query_log='ON';
set global long_query_time=1;
```
方式二：配置文件设置：（配置后需重启服务）
```
[mysqld]
slow_query_log = ON
slow_query_log_file = /var/run/mysqld/mysqld-slow.log
long_query_time = 1
```
